<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Promesas JavaScript</title>
</head>

<body>
  <h1>Promesas JavaScript-Hola--</h1>
  <script>
    console.log("Promesas");


    function cuadradoPromise(value) {
      if (typeof value !== "number") {
        return Promise.reject(`Error, el valor "${value}" ingresado no es un numero`);
      }
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve({
            value,
            result: value * value
          });
        }, 0 | Math.random() * 100);
      });
    }

    cuadradoPromise(0)
      .then(obj => {
        //console.log(obj);
        console.log("Iniciio Promise");
        console.log(`Promise: ${obj.value} ,  ${obj.result}`);
        return cuadradoPromise(1);
      })
      .then(obj => {
        console.log(`Promise: ${obj.value} ,  ${obj.result}`);
        return cuadradoPromise(2);
      })
      .then(obj => {
        console.log(`Promise: ${obj.value} ,  ${obj.result}`);
        return cuadradoPromise(3);
      })
      .then(obj => {
        console.log(`Promise: ${obj.value} ,  ${obj.result}`);
        return cuadradoPromise(4);
      })
      .then(obj => {
        console.log(`Promise: ${obj.value} ,  ${obj.result}`);
        return cuadradoPromise(5);
      })
      .then(obj => {
        console.log(`Promise: ${obj.value} ,  ${obj.result}`);
        console.log("Fin promise");
      })
      .catch(err => console.error(err));
    //************************************************************
    //Await, Funciones Asincronas

    function cuadradoPromise(value) {
      if (typeof value !== "number") {
        return Promise.reject(`Error, el valor "${value}" ingresado no es un numero`);
      }
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve({
            value,
            result: value * value
          });
        }, 0 | Math.random() * 100);
      });
    }

    async function funcionAsincronaDeclarada() {

      try {
        console.log("Inicio Async Function");

        let obj = await cuadradoPromise(0); //Await espera  que termine la funcion, antes de pasar a la siguiente. Await va con Async
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(1);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(2);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(3);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(4);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(5);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        console.log("Fin Async Function");
      } catch (err) {

        console.error(err);
      }
    }

    funcionAsincronaDeclarada();

    //Lo mismo que la anterior, pero expresda. 

    const funcionAsincronaExpresada = async () => {

      try {
        console.log("Inicio Async Function");

        let obj = await cuadradoPromise(6); //Await espera  que termine la funcion, antes de pasar a la siguiente
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(7);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(8);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(9);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(10);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(5);
        console.log(`Asynca Fnction: ${obj.value}, ${obj.result}`);

        console.log("Fin Async Function");
      } catch (err) {

        console.error(err);
      }
    }

    funcionAsincronaExpresada();
  </script>
</body>

</html>